# Реализация пункта 4: Python GUI для системы авиаперевозок

## Обзор реализации

Данный документ описывает реализацию пункта 4 задания - создание пользовательского интерфейса на языке Python с использованием библиотеки, созданной из C++ кода.

## Созданные компоненты

### 1. C API Wrapper (`FlightScheduleAPI.h` и `FlightScheduleAPI.cpp`)

Создан C-совместимый интерфейс для экспорта C++ классов в DLL:

- **Schedule API**: функции для работы с расписанием рейсов
- **Flight API**: функции для работы с отдельными рейсами
- **Aircraft API**: функции для работы с самолётами
- **Airport API**: функции для работы с аэропортами
- **Cargo API**: функции для работы с грузами
- **UrgentCargo API**: функции для работы со срочными грузами
- **Passenger API**: функции для работы с пассажирами

Все функции используют C-совместимые типы данных и могут быть вызваны из Python через ctypes.

### 2. Python привязки (`python_bindings/flight_schedule_lib.py`)

Реализованы Python-классы-обёртки для всех C++ классов:

- `Schedule` - класс для работы с расписанием
- `Flight` - класс для работы с рейсами
- `Aircraft` - класс для работы с самолётами
- `Airport` - класс для работы с аэропортами
- `Cargo` - класс для работы с грузами
- `UrgentCargo` - класс для работы со срочными грузами
- `Passenger` - класс для работы с пассажирами

Каждый класс предоставляет Pythonic интерфейс, скрывающий детали работы с DLL.

### 3. Графический интерфейс (`python_bindings/flight_schedule_gui.py`)

Создан полнофункциональный GUI на основе tkinter с следующими вкладками:

1. **Расписание** - просмотр всего расписания, проверка валидности
2. **Рейсы** - добавление и удаление рейсов
3. **Самолёты** - управление самолётами
4. **Аэропорты** - управление аэропортами
5. **Грузы** - добавление обычных и срочных грузов
6. **Пассажиры** - управление пассажирами
7. **Отчёты** - получение отчётов о расписании и просроченных грузах

### 4. Скрипты сборки

- `build_dll.bat` - автоматическая сборка DLL из командной строки
- Инструкции по сборке через Visual Studio

### 5. Документация

- `PYTHON_GUI_README.md` - подробное руководство
- `QUICK_START.md` - быстрый старт
- `PYTHON_GUI_IMPLEMENTATION.md` - этот файл

### 6. Тестовые скрипты

- `test_api.py` - проверка работоспособности API

## Структура файлов

```
Cargo_5th_term/
├── FlightScheduleAPI.h              # Заголовочный файл C API
├── FlightScheduleAPI.cpp            # Реализация C API
├── build_dll.bat                    # Скрипт сборки DLL
├── PYTHON_GUI_README.md             # Подробная документация
├── QUICK_START.md                   # Быстрый старт
├── PYTHON_GUI_IMPLEMENTATION.md     # Описание реализации
└── python_bindings/
    ├── __init__.py                  # Инициализация модуля
    ├── flight_schedule_lib.py       # Python привязки
    ├── flight_schedule_gui.py       # Графический интерфейс
    └── test_api.py                  # Тестовый скрипт
```

## Основные особенности реализации

### 1. C API Design

- Все функции используют простые типы (void*, char*, int, double, long long)
- Буферы для строк передаются с указанием размера для безопасности
- Все функции защищены обработкой исключений
- Используется паттерн Handle (void*) для представления объектов

### 2. Python Bindings

- Используется стандартная библиотека `ctypes` (не требуется внешних зависимостей)
- Автоматическое управление памятью через деструкторы
- Удобные Python-методы для работы с датами/временем
- Автоматическое преобразование строк между C и Python

### 3. GUI Features

- Интуитивно понятный интерфейс с вкладками
- Проверка ввода данных
- Человекочитаемый вывод информации
- Автоматическая загрузка тестовых данных
- Поддержка всех основных операций системы

## Соответствие требованиям задания

✅ **Преобразование C++ программы в DLL**: 
   - Создан C API wrapper
   - Все классы экспортируются через DLL

✅ **Python привязки**: 
   - Реализованы через ctypes
   - Предоставляют удобный Python интерфейс

✅ **Графический интерфейс**: 
   - Использует tkinter (стандартная библиотека Python)
   - Покрывает все основные сценарии использования

✅ **Документация**: 
   - Подробные инструкции по сборке
   - Руководство пользователя
   - Примеры использования

## Использование

### Сборка DLL

```batch
# Использование скрипта
build_dll.bat

# Или через Visual Studio (см. PYTHON_GUI_README.md)
```

### Запуск GUI

```cmd
cd python_bindings
python flight_schedule_gui.py
```

### Тестирование API

```cmd
cd python_bindings
python test_api.py
```

## Примеры кода

### Использование Python API

```python
from flight_schedule_lib import Schedule, Flight
from datetime import datetime, timedelta

# Создаём расписание
schedule = Schedule()

# Создаём рейс
now = datetime.now()
flight = Flight("FL-001", "Шереметьево", "Домодедово",
               now + timedelta(hours=1),
               now + timedelta(hours=2),
               "A-001")

# Добавляем рейс
schedule.add_flight(flight)

# Получаем расписание
print(schedule.to_string())

# Проверяем валидность
if schedule.is_valid():
    print("Расписание корректно")
else:
    errors = schedule.get_validation_errors()
    print("Ошибки:", errors)
```

## Технические детали

### Управление памятью

- Объекты C++ создаются через `new` в C API
- Python классы автоматически вызывают деструкторы через `__del__`
- Используется RAII паттерн

### Обработка ошибок

- Все C функции защищены try-catch блоками
- Возвращаются коды ошибок или nullptr
- Python исключения генерируются при ошибках

### Совместимость

- DLL компилируется для x64 (можно изменить на x86)
- Требует совместимой версии Python (x64 для x64 DLL)
- Работает на Windows (можно портировать на Linux/Mac)

## Возможные улучшения

1. **Сохранение/загрузка данных**: Добавить возможность сохранения расписания в файл
2. **Расширенная валидация**: Более детальная проверка данных в GUI
3. **Графики**: Визуализация расписания в виде диаграмм
4. **Экспорт отчётов**: Сохранение отчётов в PDF/Excel
5. **Многопоточность**: Асинхронная обработка операций

## Заключение

Реализован полнофункциональный Python GUI для системы управления расписанием авиаперевозок, который:
- Преобразует C++ код в DLL
- Предоставляет удобные Python привязки
- Включает графический интерфейс со всеми необходимыми функциями
- Содержит подробную документацию и примеры

Все требования пункта 4 задания выполнены.

