# Реализация пункта 4: Python GUI для системы авиаперевозок

## Обзор реализации

Данный документ описывает реализацию пункта 4 задания - создание пользовательского интерфейса на языке Python с использованием библиотеки, созданной из C++ кода.

## Созданные компоненты

### 1. C API Wrapper (`FlightScheduleAPI.h` и `FlightScheduleAPI.cpp`)

Создан C-совместимый интерфейс для экспорта C++ классов в DLL:

- **Schedule API**: функции для работы с расписанием рейсов
- **Flight API**: функции для работы с отдельными рейсами
- **Aircraft API**: функции для работы с самолётами
- **Airport API**: функции для работы с аэропортами
- **Cargo API**: функции для работы с грузами
- **UrgentCargo API**: функции для работы со срочными грузами
- **Passenger API**: функции для работы с пассажирами

Все функции используют C-совместимые типы данных и могут быть вызваны из Python через ctypes.

### 2. Python привязки (`python_bindings/flight_schedule_lib.py`)

Реализованы Python-классы-обёртки для всех C++ классов:

- `Schedule` - класс для работы с расписанием
- `Flight` - класс для работы с рейсами
- `Aircraft` - класс для работы с самолётами
- `Airport` - класс для работы с аэропортами
- `Cargo` - класс для работы с грузами
- `UrgentCargo` - класс для работы со срочными грузами
- `Passenger` - класс для работы с пассажирами

Каждый класс предоставляет Pythonic интерфейс, скрывающий детали работы с DLL.

### 3. Графический интерфейс (`python_bindings/flight_schedule_gui.py`)

Создан полнофункциональный GUI на основе tkinter с следующими вкладками:

1. **Расписание** - просмотр всего расписания, проверка валидности
2. **Рейсы** - добавление и удаление рейсов
3. **Самолёты** - управление самолётами
4. **Аэропорты** - управление аэропортами
5. **Грузы** - добавление обычных и срочных грузов
6. **Пассажиры** - управление пассажирами
7. **Отчёты** - получение отчётов о расписании и просроченных грузах

### 4. Скрипты сборки

- `build_dll.bat` - автоматическая сборка DLL из командной строки
- Инструкции по сборке через Visual Studio

### 5. Документация

- [дополнительно/PYTHON_GUI_README.md](дополнительно/PYTHON_GUI_README.md) — подробное руководство
- [дополнительно/QUICK_START.md](дополнительно/QUICK_START.md) — быстрый старт
- [УСТРАНЕНИЕ_ПРОБЛЕМ.md](УСТРАНЕНИЕ_ПРОБЛЕМ.md) — решение проблем с DLL

### 6. Тестовые скрипты

- `test_api.py` - проверка работоспособности API

## Структура файлов

```
Cargo_5th_term/
├── include/                         # Заголовки C++
├── src/                             # Исходники C++
├── FlightScheduleAPI.h / .cpp        # C API
├── build_dll.bat                    # Скрипт сборки DLL
├── docs/                            # Документация
│   ├── ОПИСАНИЕ_ПРОГРАММЫ.md
│   ├── УСТРАНЕНИЕ_ПРОБЛЕМ.md
│   └── РЕАЛИЗАЦИЯ_PYTHON_GUI.md     # этот файл
├── PYTHON_GUI_README.md
├── QUICK_START.md
└── python_bindings/
    ├── flight_schedule_lib.py       # Python привязки
    ├── flight_schedule_gui.py       # GUI
    └── test_api.py
```

## Основные особенности реализации

### 1. C API Design

- Все функции используют простые типы (void*, char*, int, double, long long)
- Буферы для строк передаются с указанием размера для безопасности
- Все функции защищены обработкой исключений
- Используется паттерн Handle (void*) для представления объектов

### 2. Python Bindings

- Используется стандартная библиотека `ctypes` (не требуется внешних зависимостей)
- Автоматическое управление памятью через деструкторы
- Удобные Python-методы для работы с датами/временем
- Автоматическое преобразование строк между C и Python

### 3. GUI Features

- Интуитивно понятный интерфейс с вкладками
- Проверка ввода данных
- Человекочитаемый вывод информации
- Автоматическая загрузка тестовых данных
- Поддержка всех основных операций системы

## Соответствие требованиям задания

✅ **Преобразование C++ программы в DLL**: C API wrapper, все классы экспортируются через DLL  
✅ **Python привязки**: реализованы через ctypes, удобный Python интерфейс  
✅ **Графический интерфейс**: tkinter, все основные сценарии  
✅ **Документация**: инструкции по сборке, руководство, примеры  

## Использование

Сборка DLL: `build_dll.bat` (из x64 Native Tools Command Prompt).  
Запуск GUI: `cd python_bindings && python flight_schedule_gui.py`  
Тестирование API: `cd python_bindings && python test_api.py`

## Пример кода

```python
from flight_schedule_lib import Schedule, Flight
from datetime import datetime, timedelta

schedule = Schedule()
now = datetime.now()
flight = Flight("FL-001", "Шереметьево", "Домодедово",
               now + timedelta(hours=1), now + timedelta(hours=2), "A-001")
schedule.add_flight(flight)
print(schedule.to_string())
```

## Технические детали

- Объекты C++ создаются через C API; Python-обёртки вызывают Destroy в `__del__`.
- C функции защищены try-catch; Python получает коды ошибок или исключения.
- DLL компилируется для x64; требуется 64-bit Python для 64-bit DLL.

Все требования пункта 4 задания выполнены.
